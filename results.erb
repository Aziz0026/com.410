\documentclass[12pt,a4paper,oneside,notitlepage]{article}

\newcommand{\documenttitle}
{COM 410, 1799, Computer Architecture}
\newcommand{\documentsubject}
{Lab Grades}
\newcommand{\documenttags}
{COM, 410, 1799, computer, architecture, lab, grades}

\newcommand{\documentauthor}
{Toksaitov Dmitrii Alexandrovich}
\newcommand{\documentauthoremail}
{\texttt{\href{mailto:toksaitov.d@gmail.com}{toksaitov.d@gmail.com}}}

\usepackage{hyperref}
\hypersetup{
    pdftitle={\documenttitle},%
    pdfauthor={\documentauthor},%
    pdfsubject={\documentsubject},%
    pdfkeywords={\documenttags},%
    colorlinks,linkcolor=black,citecolor=black,filecolor=black,urlcolor=black
}

\usepackage[landscape]{geometry}
\usepackage[table]{xcolor}

\setlength{\parindent}{0cm}
\pagestyle{empty}

\begin{document}

    \footnotesize

    {\large
        \textbf{\documenttitle, \documentsubject}\\
        \documentauthor, \documentauthoremail\\
        \\
        \today
    }

    \subsection*{Results}
    \addcontentsline{toc}{subsection}{Results}

    \begin{tabular}{ | c | l *{6}{| c } | r | r | r | }

        \hline
        \textbf{\#} &
        \textbf{Name}     & \textbf{Task \#1} & \textbf{Task \#2}   & 
        \textbf{Task \#3} & \textbf{Task \#4} & \textbf{Bonus Task} & 
        \textbf{Bonus} & 
        \textbf{Total}  (<%= TOTAL_MAX %>)  & 
        \textbf{Result} (<%= "#{MAX_RESULT.to_i()}\\%" %>) & 
        \textbf{Grade}\\

        <% PARSED_DATA.each_with_index do |row, i| %>
            \hline
            <%= i + 1 %> &
            <%= row.first %> & 
            <% row.last[0..-4].each do |value| %>
                \cellcolor[gray]{<%= [1 - value.to_f()/6, 1].min rescue 1 %>} 
                <%= value %> & 
            <% end %>
            <%= row.last[-3] %> & 
            \cellcolor[gray]{<%= 1 - row.last[-2] / 500.0 %>} 
            <%= row.last[-2] %>\% & 
            <%= row.last[-1] %>\\
        <% end %>

        \hline

    \end{tabular}

    \subsection*{Notes}
    \addcontentsline{toc}{subsection}{Notes}

    \begin{itemize}
        \item The maximum value for each task is <%= MAX_VALUE_FOR_TASK %>.

        \item If you have a question mark in the grade field, you need to 
        contact me as soon as possible.
    \end{itemize}

\end{document}

